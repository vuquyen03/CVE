# Piranha CMS – Stored XSS via Excerpt Field

**Affected product:** Piranha CMS v12.1

**Vulnerability type:** Stored Cross-Site Scripting (XSS) via page Excerpt field

## Summary

The application allows authenticated users to input content into the **Excerpt** field when creating or editing pages. This content is stored and later rendered on the frontend without proper sanitization. As a result, malicious JavaScript injected into the Excerpt field is executed when the page is previewed or publicly accessed.

## Impact

- Execution of arbitrary JavaScript in the context of the victim’s browser  
- Exposure of sensitive user information  
- Abuse of trusted content rendered by the Piranha CMS frontend  

## Technical Description

- Pages can be created or edited via the **Page Editor** in Piranha CMS.  
- The **Excerpt** field accepts user-supplied input and stores it in the system configuration.  
- The application does **not properly sanitize or filter HTML/JavaScript content** in the Excerpt field.  
- An attacker with permission to create or edit pages can inject malicious JavaScript into this field.  
- When the affected page is previewed or accessed publicly after publication, the browser executes the injected JavaScript.

## Attack Scenario

1. Attacker logs into Piranha CMS with an account permitted to create or edit pages.  
2. Attacker creates a new page (e.g., **Standard Page** or **Standard Archive Page**) or edits an existing one.  
3. Malicious JavaScript is injected into the **Excerpt** field via the page settings.  
4. The page is saved and previewed, or published and accessed by visitors.  
5. The injected JavaScript executes in the victim’s browser, resulting in a Stored XSS condition.

## Proof of Concept

A JavaScript payload was injected into the **Excerpt** field of a page.  
When the page is previewed or accessed after publication, the payload executes, demonstrating the stored XSS vulnerability.

## Steps to Reproduce

1. Log in to Piranha CMS as an authenticated user via `/manager/login`.  
2. Navigate to **Pages** and create a new page or select an existing one.  
3. Enter a title, open the page settings, and insert a JavaScript payload into the **Excerpt** field.  
4. Click **Save**, then click **Preview** or publish the page.  
5. Observe that the JavaScript executes in the browser.
