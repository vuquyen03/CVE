# ERPNext v15.89.0 and Frappe Framework v15.89.0 - Stored XSS via File Upload

**Affected product:** ERPNext v15.89.0 and Frappe Framework v15.89.0  

**Vulnerability type:** Stored XSS via user-uploaded XML/HTM file in the attachment feature

## Summary

The application allows users to upload **XML or HTM files** containing malicious JavaScript through the **file attachment feature**. When an administrator accesses the uploaded file via its direct link, the embedded script executes in the admin's browser.

## Impact

- Potential privilege escalation by executing actions on behalf of an admin.  

- Unauthorized modification or manipulation of application data.  

- Unauthorized access to sensitive information.  

- Execution of arbitrary JavaScript in the admin’s browser.

## Affected Versions

- ERPNext v15.89.0  

- Frappe Framework v15.89.0  

## Technical Description

- Uploaded `.XML` or `.HTM` files are stored under `/private/files/`.  

- Files are accessible only to the uploader and administrators.  

- The application **does not sanitize or strip embedded JavaScript** in these files.  

- An attacker can upload a malicious file containing executable script.  

- When an administrator views the file content through its direct file URL, the **browser executes the embedded JavaScript in the admin session context**.

**Attack scenario:**  

1. Attacker logins and uploads a `.XML` or `.HTM` file containing malicious payloads via Attachments in private mode.  

2. Administrator clicks the link to view the attachment.  

3. Script executes in the admin’s browser, potentially allowing actions with admin privileges.


## References

- [Frappe GitHub](https://github.com/frappe/frappe)  

- [ERPNext GitHub](https://github.com/frappe/erpnext)