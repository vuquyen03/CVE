# Umbraco CMS – Stored XSS via PDF File Upload

**Affected product:** Umbraco CMS v16.3.3 

**Vulnerability type:** Stored Cross-Site Scripting (XSS) via user-uploaded PDF file

## Summary

The application allows users to upload **PDF files** containing embedded JavaScript through the **Media upload feature**. When a user accesses the uploaded PDF via the Umbraco interface, the embedded JavaScript is executed in the browser.

## Impact

- Execution of arbitrary JavaScript in the context of the victim’s browser  
- Potential session hijacking or unauthorized actions  
- Exposure of sensitive information  
- Abuse of trusted user interactions within the Umbraco CMS  

## Technical Description

- PDF files can be uploaded via the **Media** section in Umbraco CMS.  
- Uploaded files are accessible through direct links generated by the Umbraco interface.  
- The application does **not sanitize or restrict JavaScript embedded in PDF files**.  
- An attacker can upload a specially crafted PDF containing executable JavaScript.  
- When a victim opens the PDF via Umbraco, the browser executes the embedded JavaScript.

## Attack Scenario

1. Attacker logs into Umbraco CMS with an account permitted to upload media files.  
2. Attacker uploads a crafted PDF file containing malicious JavaScript through the **Media** page.  
3. The PDF is stored and made accessible via Umbraco-generated media URLs.  
4. A victim (administrator or other user) clicks the PDF link in the Umbraco interface.  
5. The embedded JavaScript executes in the victim’s browser, resulting in a Stored XSS condition.

## Proof of Concept

A sample malicious PDF file (`success_xss.pdf`) was uploaded via the Media page.  
When the file is accessed through Umbraco, the JavaScript payload executes and triggers an alert dialog.

## Steps to Reproduce

1. Log in to Umbraco CMS.  
2. Navigate to the **Media** section.  
3. Upload a crafted PDF file containing embedded JavaScript.  
4. Access the uploaded PDF via the link generated by Umbraco.  
5. Observe that JavaScript from the PDF executes in the browser.

## Notes

- The issue occurs due to the browser rendering PDF files that contain executable JavaScript.
